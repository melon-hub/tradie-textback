<!DOCTYPE html>
<html>
<head>
    <title>Tradie Textback - User Flow Diagrams</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1, h2, h3 {
            color: #333;
        }
        .diagram-container {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üîß Tradie Textback - User Flow Diagrams</h1>
    
    <div class="warning">
        <strong>‚ö†Ô∏è Current Issues:</strong> The user type naming is backwards! "Client" = Tradie and "Tradie" = Admin. This needs fixing!
    </div>

    <h2>Current System Flows</h2>

    <div class="diagram-container">
        <h3>1. New Visitor Flow</h3>
        <pre class="mermaid">
flowchart TD
    A[Landing Page /] --> B{Choose Action}
    B --> C[Auth Page /auth]
    C --> D[Phone Login - SMS OTP]
    C --> E[Email Login - Magic Link]
    D --> F[Dashboard]
    E --> F[Dashboard]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style F fill:#9f9,stroke:#333,stroke-width:2px
        </pre>
    </div>

    <div class="diagram-container">
        <h3>2. Tradie Business Owner Flow</h3>
        <pre class="mermaid">
flowchart TD
    A[Dashboard] --> B[Job List]
    A --> C[Job Details]
    A --> D[Settings]
    A --> E[Admin Panel<br/>if admin]
    
    B --> F[Filter Jobs]
    B --> G[Search Jobs]
    B --> H[Sort Jobs]
    
    C --> I[Edit Quote]
    C --> J[Update Status]
    C --> K[Add Notes]
    
    D --> L[Business Info]
    D --> M[Twilio Config]
    D --> N[Notifications]
    
    style A fill:#9f9,stroke:#333,stroke-width:2px
    style E fill:#ff9,stroke:#333,stroke-width:2px
        </pre>
    </div>

    <h2>üéØ Proposed Simplified Flows</h2>

    <div class="success">
        <strong>‚úÖ Key Improvement:</strong> Customers don't need accounts! They just receive SMS and optionally check status.
    </div>

    <div class="diagram-container">
        <h3>Customer Journey (No Login!)</h3>
        <pre class="mermaid">
sequenceDiagram
    participant C as Customer
    participant P as Phone System
    participant T as Twilio
    participant S as Supabase
    participant SMS as SMS Service
    
    C->>P: Calls Tradie
    P->>P: Missed Call
    P->>T: Webhook Triggered
    T->>S: Create Job Record
    S->>SMS: Send SMS to Customer
    SMS->>C: "Thanks for calling!<br/>Job #1234<br/>Status: New<br/>Link: example.com/secure/1234"
    
    Note over C: Optional - Can check status
    C->>C: Clicks Link (Optional)
    C->>S: Views Job Status<br/>(Phone verification only)
        </pre>
    </div>

    <div class="diagram-container">
        <h3>Tradie Daily Workflow</h3>
        <pre class="mermaid">
flowchart LR
    A[Check Dashboard] --> B{New Jobs?}
    B -->|Yes| C[Review Urgent First]
    B -->|No| D[Check Active Jobs]
    
    C --> E[Click Job]
    E --> F[Update Quote/Status]
    F --> G[System Sends SMS]
    G --> H[Job Updated]
    
    D --> I[Follow Up Required?]
    I -->|Yes| J[Call Customer]
    I -->|No| K[Mark Complete]
    
    style A fill:#9f9,stroke:#333,stroke-width:2px
    style G fill:#9ff,stroke:#333,stroke-width:2px
        </pre>
    </div>

    <div class="diagram-container">
        <h3>System Architecture</h3>
        <pre class="mermaid">
graph TB
    subgraph "Customer Side"
        A[Customer Phone]
    end
    
    subgraph "Twilio"
        B[Phone Number]
        C[Webhook]
        D[SMS API]
    end
    
    subgraph "Your App"
        E[Supabase Function]
        F[(Database)]
        G[React Dashboard]
    end
    
    subgraph "Tradie Side"
        H[Mobile/Desktop]
    end
    
    A -->|Calls| B
    B -->|Missed Call| C
    C -->|POST| E
    E -->|Store Job| F
    E -->|Send SMS| D
    D -->|Deliver| A
    
    H -->|View/Update| G
    G -->|Read/Write| F
    F -->|Trigger SMS| D
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style H fill:#9f9,stroke:#333,stroke-width:2px
        </pre>
    </div>

    <div class="diagram-container">
        <h3>Implementation Priority</h3>
        <pre class="mermaid">
gantt
    title Implementation Roadmap
    dateFormat  YYYY-MM-DD
    section Critical
    Fix user type naming    :crit, a1, 2024-01-15, 2d
    Remove customer login   :crit, a2, after a1, 3d
    section Important
    Mobile optimization     :b1, after a2, 5d
    Simplify job flow      :b2, after a2, 4d
    section Nice to Have
    Advanced analytics     :c1, after b1, 7d
    Bulk operations        :c2, after b2, 5d
        </pre>
    </div>

</body>
</html>